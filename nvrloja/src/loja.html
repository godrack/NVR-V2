<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <link rel="icon" href="favicon.png" type="image/png">
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Nova Vibe Roleplay ‚Äî Loja Oficial</title>
  <style>
    * { margin:0; padding:0; box-sizing:border-box; }
    
    :root {
      --bg-primary: #121216;
      --bg-secondary: #1c1e28;
      --accent: #2f3a5a;
      --accent-hover: #3f4b76;
      --text: #fff;
      --text-muted: #ccc;
      --border: #2f3a5a;
      --success: #27ae60;
      --danger: #e74c3c;
      --danger-hover: #c0392b;
    }
    
    body { 
      background: var(--bg-primary); 
      color: var(--text); 
      font-family: 'Segoe UI', sans-serif; 
      min-height: 100vh; 
      padding-top: 65px;
    }
    
    .container { 
      width: 90%; 
      max-width: 1200px; 
      margin: 0 auto; 
      padding: 20px 0; 
    }
    
    /* Header */
    header { 
      position: fixed; 
      top: 0; 
      left: 0; 
      width: 100%; 
      background: var(--bg-primary); 
      border-bottom: 1px solid var(--border); 
      z-index: 1001; 
      padding: 10px 0; 
    }
    
    .header-content { 
      display: flex; 
      justify-content: space-between; 
      align-items: center; 
      width: 90%; 
      max-width: 1200px; 
      margin: 0 auto; 
    }
    
    .header-left h1 { 
      font-size: 1.8rem; 
      color: var(--text); 
      margin: 0; 
      cursor: pointer;
      transition: color 0.3s ease;
    }
    .header-left h1:hover { color: var(--accent); }
    
    .header-right { 
      display: flex; 
      align-items: center; 
      gap: 20px; 
    }
    
    .header-btn { 
      background: transparent; 
      border: 1px solid var(--border); 
      color: var(--text); 
      padding: 8px 12px; 
      border-radius: 6px; 
      cursor: pointer; 
      transition: all 0.3s ease; 
      font-size: 0.9rem; 
      display: flex; 
      align-items: center; 
      gap: 8px; 
      text-decoration: none; 
      position: relative;
    }
    
    .header-btn:hover { 
      background: var(--accent); 
      transform: translateY(-1px); 
    }
    
    .header-btn.login { background: var(--accent); }
    .header-btn.login:hover { background: var(--accent-hover); }
    .header-btn.logout { background: var(--danger); border-color: var(--danger); }
    .header-btn.logout:hover { background: var(--danger-hover); border-color: var(--danger-hover); }
    
    .user-greeting {
      color: var(--text);
      font-size: 0.9rem;
      opacity: 0.8;
      margin-right: 10px;
    }
    
    .cart-badge {
      position: absolute;
      top: -8px;
      right: -8px;
      background: var(--danger);
      color: var(--text);
      border-radius: 50%;
      width: 18px;
      height: 18px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 0.7rem;
      font-weight: bold;
    }
    
    /* Navigation */
    nav { 
      margin: 20px 0; 
      text-align: center; 
      padding: 10px 0; 
      border-bottom: 1px solid var(--border); 
    }
    nav a { 
      color: var(--text); 
      text-decoration: none; 
      padding: 10px 16px; 
      margin: 0 6px; 
      border-radius: 4px; 
      transition: background 0.2s ease; 
      cursor: pointer; 
    }
    nav a:hover { background: var(--accent); }
    
    /* Filter Buttons */
    .filter-buttons { 
      text-align: center; 
      margin: 30px 0 15px; 
    }
    
    .filter-buttons button {
      background: transparent; 
      border: 1.5px solid var(--border); 
      color: var(--text); 
      padding: 8px 18px;
      margin: 0 10px 10px 0; 
      border-radius: 4px; 
      font-weight: 600; 
      cursor: pointer; 
      transition: all 0.25s ease; 
      font-size: 0.9rem;
    }
    
    .filter-buttons button:hover, 
    .filter-buttons button.active { 
      background: var(--accent); 
    }
    
    /* Product Grid */
    .product-list { 
      display: grid; 
      grid-template-columns: repeat(3, 1fr); 
      gap: 24px; 
    }
    
    .product-item { 
      background: var(--bg-secondary); 
      border-radius: 8px; 
      padding: 18px; 
      display: flex; 
      flex-direction: column; 
      border: 1px solid transparent; 
      transition: all 0.3s ease; 
    }
    
    .product-item:hover { 
      border-color: var(--accent); 
      transform: translateY(-2px); 
    }
    
    .product-item img { 
      width: 100%; 
      height: 160px; 
      object-fit: cover; 
      border-radius: 6px; 
      margin-bottom: 14px; 
      background: var(--accent); 
    }
    
    .product-item h3 { margin-bottom: 10px; }
    .product-item p { 
      flex-grow: 1; 
      color: var(--text-muted); 
      margin-bottom: 12px; 
      font-size: 0.9rem; 
    }
    .product-item p strong { 
      color: var(--text); 
      font-size: 1.05rem; 
    }
    
    .product-item button {
      background: var(--accent); 
      color: var(--text); 
      border: none; 
      padding: 10px; 
      border-radius: 6px; 
      cursor: pointer; 
      font-weight: 600;
      transition: all 0.3s ease;
    }
    
    .product-item button:hover { 
      background: var(--accent-hover); 
      transform: translateY(-1px); 
    }
    
    /* Cart */
    #cart-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.7);
      z-index: 1000;
      display: none;
      backdrop-filter: blur(2px);
    }
    
    #cart {
      position: fixed; 
      top: 0; 
      right: -300px; 
      width: 280px; 
      height: 100%; 
      background: var(--bg-secondary);
      color: var(--text); 
      padding: 20px; 
      box-shadow: -4px 0 12px rgba(0,0,0,0.4); 
      transition: right 0.3s ease;
      overflow-y: auto; 
      z-index: 1002; 
      border-left: 1px solid var(--border);
    }
    
    #cart.open { right: 0; }
    #cart h2 { font-size: 1.4rem; margin-bottom: 15px; }
    #cart ul { list-style: none; padding: 0; margin-bottom: 20px; }
    #cart ul li {
      margin-bottom: 10px; 
      border-bottom: 1px solid var(--border); 
      padding-bottom: 8px; 
      font-size: 0.9rem;
    }
    #cart ul li .item-info { margin-bottom: 5px; }
    #cart ul li .item-controls { 
      display: flex; 
      align-items: center; 
      gap: 10px; 
    }
    #cart ul li .item-controls button { 
      background: var(--accent); 
      border: none; 
      color: var(--text); 
      padding: 4px 8px; 
      border-radius: 3px; 
      cursor: pointer; 
      font-size: 0.8rem;
    }
    #cart ul li .item-controls button:hover { background: var(--accent-hover); }
    #cart button { 
      background: var(--accent-hover); 
      border: none; 
      color: var(--text); 
      padding: 10px; 
      width: 100%; 
      border-radius: 4px; 
      cursor: pointer; 
      font-weight: 600; 
      margin-top: 10px; 
      transition: all 0.3s ease; 
    }
    #cart button:hover { 
      background: #4f5d9e; 
      transform: translateY(-1px); 
    }
    
    /* Footer */
    footer { 
      margin-top: 50px; 
      padding: 20px 0; 
      text-align: center; 
      border-top: 1px solid var(--border); 
      color: #bbb; 
      font-size: 0.9rem; 
    }
    
    /* Responsive */
    @media (max-width: 768px) { 
      .product-list { grid-template-columns: repeat(2, 1fr); }
      #cart { width: 100%; right: -100%; }
      .header-right { gap: 10px; }
      .header-btn { padding: 6px 10px; font-size: 0.8rem; }
      .header-left h1 { font-size: 1.5rem; }
      .user-greeting { font-size: 0.8rem; }
    }
    
    @media (max-width: 500px) { 
      .product-list { grid-template-columns: 1fr; }
      .header-content { width: 95%; }
      .header-right { gap: 8px; }
      .header-btn { padding: 5px 8px; font-size: 0.75rem; }
      .header-left h1 { font-size: 1.3rem; }
      .user-greeting { font-size: 0.7rem; }
    }
  </style>
</head>
<body>

<header>
  <div class="header-content">
    <div class="header-left">
      <h1 style="cursor:pointer;" onclick="window.location.href='https://novaviberoleplay.netlify.app'">Nova Vibe Roleplay</h1>
    </div>
    <div class="header-right" id="header-right">
      <span id="user-greeting" class="user-greeting" style="display: none;"></span>
      <button class="header-btn" onclick="openCart()">
        üõí Carrinho
        <span id="cart-badge-header" class="cart-badge" style="display: none;">0</span>
      </button>
      <button class="header-btn login" id="login-btn" onclick="irParaLogin()" style="display: block;">Entrar</button>
      <button class="header-btn logout" id="logout-btn" onclick="fazerLogout()" style="display: none;">Sair</button>
    </div>
  </div>
</header>

<nav style="display: none;">
  <a href="#" onclick="scrollToTop()">In√≠cio</a>
</nav>

<div class="filter-buttons">
  <button data-filter="all" class="active" onclick="filterProducts('all')">Todos</button>
  <button data-filter="casas" onclick="filterProducts('casas')">Casas</button>
  <button data-filter="veiculos" onclick="filterProducts('veiculos')">Ve√≠culos</button>
  <button data-filter="extras" onclick="filterProducts('extras')">Extras</button>
</div>

<main class="container">
  <section class="product-list">
    <div class="product-item" data-category="casas">
      <img src="https://five-rp.de/wp-content/uploads/2024/07/chrome_nQisegy55l-1024x573.jpg.webp" alt="Mans√£o Vista Mar" />
      <h3>Mans√£o Vista Mar</h3>
      <p>Luxo √† beira-mar com garagem p/ 5 carros.</p>
      <p><strong>R$ 259,00</strong></p>
      <button onclick="addToCart('Mans√£o Vista Mar', 259)">Adicionar ao Carrinho</button>
    </div>

    <div class="product-item" data-category="veiculos">
      <img src="https://img.gta5-mods.com/q95/images/lamborghini-urus-2018-add-on/2b9a2a-PGTA51544780450.jpg" alt="Supercarro ZX9" />
      <h3>Lamborghini Urus</h3>
      <p>V12 Biturbo, o mais veloz da cidade.</p>
      <p><strong>R$ 149,00</strong></p>
      <button onclick="addToCart('Lamborghini Urus', 149)">Adicionar ao Carrinho</button>
    </div>

    <div class="product-item" data-category="extras">
      <img src="https://storage.hydrus.gg/production/packages/mwUds4zV929tBziSfiAs5gG64TqNnwOlcjCXZsKIqVPsixKUiR1DXeGtOUjmGPfq.png" alt="VIP Gold" />
      <h3>VIP Ouro (30d)</h3>
      <p>Acesso VIP com benef√≠cios exclusivos.</p>
      <p><strong>R$ 99,00</strong></p>
      <button onclick="addToCart('VIP Ouro (30d)', 99)">Adicionar ao Carrinho</button>
    </div>

    <div class="product-item" data-category="casas">
      <img src="https://img.gta5-mods.com/q95/images/single-player-mode-custom-apartment-menyoo-mapeditor-adco1234/6f0395-9e73e5-46f5ac-GTA5%202016-05-02%2012-17-12-54_%E5%89%AF%E6%9C%AC.png" alt="Apartamento Moderno" />
      <h3>Apartamento Moderno</h3>
      <p>Localiza√ß√£o central com vista panor√¢mica.</p>
      <p><strong>R$ 180,00</strong></p>
      <button onclick="addToCart('Apartamento Moderno', 180)">Adicionar ao Carrinho</button>
    </div>

    <div class="product-item" data-category="veiculos">
      <img src="https://img.gta5-mods.com/q95/images/2020-yamaha-yzf-r1-r1m/b82192-a.jpg" alt="Moto Esportiva" />
      <h3>Moto Esportiva R1</h3>
      <p>Velocidade e agilidade nas ruas.</p>
      <p><strong>R$ 85,00</strong></p>
      <button onclick="addToCart('Moto Esportiva R1', 85)">Adicionar ao Carrinho</button>
    </div>

    <div class="product-item" data-category="extras">
      <img src="https://storage.hydrus.gg/production/packages/yKxKYS3wtu4Xz1Y6N2ui9TM0oTUpYOKTrLx7bTSqW8BREpXUWLp5wojEkwMRBkgc.png" alt="VIP Premium" />
      <h3>VIP Permanente</h3>
      <p>M√°ximo de privil√©gios no servidor.</p>
      <p><strong>R$ 1.390,00</strong></p>
      <button onclick="addToCart('VIP Permanente', 1390)">Adicionar ao Carrinho</button>
    </div>
  </section>
</main>

<footer>
  <div class="container">&copy; 2025 Nova Vibe RP ‚Äî Todos os direitos reservados.</div>
</footer>

<!-- Cart Overlay -->
<div id="cart-overlay" onclick="closeCart()"></div>

<div id="cart">
  <h2>Carrinho</h2>
  <ul id="cart-items"></ul>
  <div id="cart-total" style="margin-top: 15px; font-weight: bold; font-size: 1rem; border-top: 1px solid var(--border); padding-top: 15px;">
    Total: R$ 0,00
  </div>
  <button id="finalizar-btn" style="display:none;" onclick="finalizarCompra()">Finalizar Compra</button>
  <button id="limpar-btn" style="display:none;" onclick="limparCarrinho()">Limpar Carrinho</button>
</div>

<script>
  // Cache DOM elements
  const cartItems = document.getElementById('cart-items');
  const cart = document.getElementById('cart');
  const cartOverlay = document.getElementById('cart-overlay');
  const cartTotal = document.getElementById('cart-total');
  const userGreeting = document.getElementById('user-greeting');
  const loginBtn = document.getElementById('login-btn');
  const logoutBtn = document.getElementById('logout-btn');
  const badges = [document.getElementById('cart-badge'), document.getElementById('cart-badge-header')];
  const finalizarBtn = document.getElementById('finalizar-btn');
  const limparBtn = document.getElementById('limpar-btn');

  let carrinho = [];

  // Utility functions
  const getUserData = () => JSON.parse(localStorage.getItem('nova_vibe_user'));
  const isValidToken = (userData) => userData.expires_at && new Date(userData.expires_at * 1000) > new Date();
  const isLoggedIn = () => {
    const userData = getUserData();
    if (userData?.logged_in && userData.name && userData.email) {
      if (isValidToken(userData)) return true;
      localStorage.removeItem('nova_vibe_user');
    }
    return false;
  };

  // Update UI based on login status
  function updateLoginUI() {
    if (isLoggedIn()) {
      const userData = getUserData();
      const primeiroNome = userData.name.trim().split(' ')[0];
      userGreeting.textContent = `Ol√°, ${primeiroNome}`;
      userGreeting.style.display = 'block';
      loginBtn.style.display = 'none';
      logoutBtn.style.display = 'block';
    } else {
      userGreeting.style.display = 'none';
      loginBtn.style.display = 'block';
      logoutBtn.style.display = 'none';
    }
  }

  // Cart functions
  function addToCart(produto, preco) {
    if (!isLoggedIn()) {
      alert("Voc√™ precisa estar logado para adicionar itens ao carrinho.");
      window.location.href = "login.html";
      return;
    }

    const itemExistente = carrinho.find(item => item.produto === produto);
    if (itemExistente) {
      itemExistente.quantidade++;
    } else {
      carrinho.push({ produto, preco: parseFloat(preco), quantidade: 1 });
    }
    
    atualizarCarrinho();
    salvarCarrinho();
    
    // Visual feedback
    const button = event.target;
    const originalText = button.textContent;
    const originalBg = button.style.background;
    
    button.textContent = 'Adicionado!';
    button.style.background = getComputedStyle(document.documentElement).getPropertyValue('--success');
    
    setTimeout(() => {
      button.textContent = originalText;
      button.style.background = originalBg;
    }, 1000);
  }

  function aumentarQuantidade(produto) {
    const item = carrinho.find(item => item.produto === produto);
    if (item) {
      item.quantidade++;
      atualizarCarrinho();
      salvarCarrinho();
    }
  }

  function diminuirQuantidade(produto) {
    const item = carrinho.find(item => item.produto === produto);
    if (item) {
      item.quantidade--;
      if (item.quantidade <= 0) {
        carrinho = carrinho.filter(i => i.produto !== produto);
      }
      atualizarCarrinho();
      salvarCarrinho();
    }
  }

  function removerItem(produto) {
    carrinho = carrinho.filter(i => i.produto !== produto);
    atualizarCarrinho();
    salvarCarrinho();
  }

  function limparCarrinho() {
    if (confirm('Tem certeza que deseja limpar o carrinho?')) {
      carrinho = [];
      atualizarCarrinho();
      salvarCarrinho();
    }
  }

  function salvarCarrinho() {
    localStorage.setItem('carrinho', JSON.stringify(carrinho));
  }

  function carregarCarrinho() {
    const carrinhoSalvo = localStorage.getItem('carrinho');
    if (carrinhoSalvo) {
      carrinho = JSON.parse(carrinhoSalvo);
      atualizarCarrinho();
    }
  }

  function atualizarCarrinho() {
    cartItems.innerHTML = '';
    let total = 0;
    let totalItens = 0;
    
    carrinho.forEach(item => {
      const li = document.createElement('li');
      li.innerHTML = `
        <div class="item-info">
          <strong>${item.produto}</strong><br>
          R$ ${item.preco.toLocaleString('pt-BR', {minimumFractionDigits: 2})}
        </div>
        <div class="item-controls">
          <button onclick="diminuirQuantidade('${item.produto}')">-</button>
          <span>${item.quantidade}</span>
          <button onclick="aumentarQuantidade('${item.produto}')">+</button>
          <button onclick="removerItem('${item.produto}')" style="background: var(--danger); margin-left: auto;">‚úï</button>
        </div>
      `;
      cartItems.appendChild(li);
      total += item.preco * item.quantidade;
      totalItens += item.quantidade;
    });
    
    cartTotal.textContent = `Total: R$ ${total.toLocaleString('pt-BR', {minimumFractionDigits: 2})}`;
    
    // Update badges
    badges.forEach(badge => {
      if (badge) {
        if (totalItens > 0) {
          badge.textContent = totalItens;
          badge.style.display = 'flex';
        } else {
          badge.style.display = 'none';
        }
      }
    });
    
    // Show/hide buttons
    const hasItems = carrinho.length > 0;
    finalizarBtn.style.display = hasItems ? 'block' : 'none';
    limparBtn.style.display = hasItems ? 'block' : 'none';
  }

  // Cart UI functions
  function openCart() {
    cart.classList.add('open');
    cartOverlay.style.display = 'block';
    document.body.style.overflow = 'hidden';
  }

  function closeCart() {
    cart.classList.remove('open');
    cartOverlay.style.display = 'none';
    document.body.style.overflow = 'auto';
  }

  function finalizarCompra() {
    if (carrinho.length === 0) {
      alert('Carrinho vazio!');
      return;
    }
    
    if (!isLoggedIn()) {
      alert("Voc√™ precisa estar logado para finalizar a compra.");
      window.location.href = "login.html";
      return;
    }
    
    window.location.href = 'checkout.html';
  }

  // Navigation functions
  function irParaLogin() {
    window.location.href = 'login.html';
  }

  function scrollToTop() {
    window.scrollTo({ top: 0, behavior: 'smooth' });
  }

  function fazerLogout() {
    if (confirm('Tem certeza que deseja fazer logout?')) {
      localStorage.removeItem('nova_vibe_user');
      localStorage.removeItem('carrinho');
      alert('Logout realizado com sucesso!');
      updateLoginUI();
      carrinho = [];
      atualizarCarrinho();
    }
  }

  // Product filter
  function filterProducts(category) {
    const products = document.querySelectorAll('.product-item');
    const buttons = document.querySelectorAll('.filter-buttons button');
    
    buttons.forEach(btn => btn.classList.remove('active'));
    document.querySelector(`[data-filter="${category}"]`).classList.add('active');
    
    products.forEach(product => {
      product.style.display = (category === 'all' || product.dataset.category === category) ? 'flex' : 'none';
    });
  }

  // Event listeners
  document.addEventListener('keydown', (e) => {
    if (e.key === 'Escape' && cart.classList.contains('open')) {
      closeCart();
    }
  });

  // Initialize
  document.addEventListener('DOMContentLoaded', () => {
    updateLoginUI();
    carregarCarrinho();
  });
</script>

</body>
</html>
